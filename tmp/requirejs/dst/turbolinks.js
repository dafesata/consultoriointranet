/*
Turbolinks 5.0.0
Copyright Â© 2016 Basecamp, LLC
 */

(function(){(function(){(function(){this.Turbolinks={supported:function(){return null!=window.history.pushState&&null!=window.requestAnimationFrame}(),visit:function(n,r){return e.controller.visit(n,r)},clearCache:function(){return e.controller.clearCache()}}}).call(this)}).call(this);var e=this.Turbolinks;(function(){(function(){var n,r;e.copyObject=function(e){var t,n,r;n={};for(t in e)r=e[t],n[t]=r;return n},e.closest=function(e,t){return n.call(e,t)},n=function(){var e,t;return e=document.documentElement,null!=(t=e.closest)?t:function(e){var t;for(t=this;t;){if(t.nodeType===Node.ELEMENT_NODE&&r.call(t,e))return t;t=t.parentNode}}}(),e.defer=function(e){return setTimeout(e,1)},e.dispatch=function(e,t){var n,r,i,s,o;return s=null!=t?t:{},o=s.target,n=s.cancelable,r=s.data,i=document.createEvent("Events"),i.initEvent(e,!0,n===!0),i.data=null!=r?r:{},(null!=o?o:document).dispatchEvent(i),i},e.match=function(e,t){return r.call(e,t)},r=function(){var e,t,n,r;return e=document.documentElement,null!=(t=null!=(n=null!=(r=e.matchesSelector)?r:e.webkitMatchesSelector)?n:e.msMatchesSelector)?t:e.mozMatchesSelector}(),e.uuid=function(){var e,t,n;for(n="",e=t=1;36>=t;e=++t)n+=9===e||14===e||19===e||24===e?"-":15===e?"4":20===e?(Math.floor(4*Math.random())+8).toString(16):Math.floor(15*Math.random()).toString(16);return n}}).call(this),function(){e.Location=function(){function e(e){var t,n;null==e&&(e=""),n=document.createElement("a"),n.href=e.toString(),this.absoluteURL=n.href,t=n.hash.length,2>t?this.requestURL=this.absoluteURL:(this.requestURL=this.absoluteURL.slice(0,-t),this.anchor=n.hash.slice(1))}var t,n,r,i;return e.wrap=function(e){return e instanceof this?e:new this(e)},e.prototype.getOrigin=function(){return this.absoluteURL.split("/",3).join("/")},e.prototype.getPath=function(){var e,t;return null!=(e=null!=(t=this.absoluteURL.match(/\/\/[^\/]*(\/[^?;]*)/))?t[1]:void 0)?e:"/"},e.prototype.getPathComponents=function(){return this.getPath().split("/").slice(1)},e.prototype.getLastPathComponent=function(){return this.getPathComponents().slice(-1)[0]},e.prototype.getExtension=function(){var e,t;return null!=(e=null!=(t=this.getLastPathComponent().match(/\.[^.]*$/))?t[0]:void 0)?e:""},e.prototype.isHTML=function(){return this.getExtension().match(/^(?:|\.(?:htm|html|xhtml))$/)},e.prototype.isPrefixedBy=function(e){var t;return t=n(e),this.isEqualTo(e)||i(this.absoluteURL,t)},e.prototype.isEqualTo=function(e){return this.absoluteURL===(null!=e?e.absoluteURL:void 0)},e.prototype.toCacheKey=function(){return this.requestURL},e.prototype.toJSON=function(){return this.absoluteURL},e.prototype.toString=function(){return this.absoluteURL},e.prototype.valueOf=function(){return this.absoluteURL},n=function(e){return t(e.getOrigin()+e.getPath())},t=function(e){return r(e,"/")?e:e+"/"},i=function(e,t){return e.slice(0,t.length)===t},r=function(e,t){return e.slice(-t.length)===t},e}()}.call(this),function(){var n=function(e,t){return function(){return e.apply(t,arguments)}};e.HttpRequest=function(){function r(r,i,s){this.delegate=r,this.requestCanceled=n(this.requestCanceled,this),this.requestTimedOut=n(this.requestTimedOut,this),this.requestFailed=n(this.requestFailed,this),this.requestLoaded=n(this.requestLoaded,this),this.requestProgressed=n(this.requestProgressed,this),this.url=e.Location.wrap(i).requestURL,this.referrer=e.Location.wrap(s).absoluteURL,this.createXHR()}return r.NETWORK_FAILURE=0,r.TIMEOUT_FAILURE=-1,r.timeout=60,r.prototype.send=function(){var e;return this.xhr&&!this.sent?(this.notifyApplicationBeforeRequestStart(),this.setProgress(0),this.xhr.send(),this.sent=!0,"function"==typeof (e=this.delegate).requestStarted?e.requestStarted():void 0):void 0},r.prototype.cancel=function(){return this.xhr&&this.sent?this.xhr.abort():void 0},r.prototype.requestProgressed=function(e){return e.lengthComputable?this.setProgress(e.loaded/e.total):void 0},r.prototype.requestLoaded=function(){return this.endRequest(function(e){return function(){var n;return 200<=(n=e.xhr.status)&&300>n?e.delegate.requestCompletedWithResponse(e.xhr.responseText,e.xhr.getResponseHeader("Turbolinks-Location")):(e.failed=!0,e.delegate.requestFailedWithStatusCode(e.xhr.status,e.xhr.responseText))}}(this))},r.prototype.requestFailed=function(){return this.endRequest(function(e){return function(){return e.failed=!0,e.delegate.requestFailedWithStatusCode(e.constructor.NETWORK_FAILURE)}}(this))},r.prototype.requestTimedOut=function(){return this.endRequest(function(e){return function(){return e.failed=!0,e.delegate.requestFailedWithStatusCode(e.constructor.TIMEOUT_FAILURE)}}(this))},r.prototype.requestCanceled=function(){return this.endRequest()},r.prototype.notifyApplicationBeforeRequestStart=function(){return e.dispatch("turbolinks:request-start",{data:{url:this.url,xhr:this.xhr}})},r.prototype.notifyApplicationAfterRequestEnd=function(){return e.dispatch("turbolinks:request-end",{data:{url:this.url,xhr:this.xhr}})},r.prototype.createXHR=function(){return this.xhr=new XMLHttpRequest,this.xhr.open("GET",this.url,!0),this.xhr.timeout=1e3*this.constructor.timeout,this.xhr.setRequestHeader("Accept","text/html, application/xhtml+xml"),this.xhr.setRequestHeader("Turbolinks-Referrer",this.referrer),this.xhr.onprogress=this.requestProgressed,this.xhr.onload=this.requestLoaded,this.xhr.onerror=this.requestFailed,this.xhr.ontimeout=this.requestTimedOut,this.xhr.onabort=this.requestCanceled},r.prototype.endRequest=function(e){return this.xhr?(this.notifyApplicationAfterRequestEnd(),null!=e&&e.call(this),this.destroy()):void 0},r.prototype.setProgress=function(e){var t;return this.progress=e,"function"==typeof (t=this.delegate).requestProgressed?t.requestProgressed(this.progress):void 0},r.prototype.destroy=function(){var e;return this.setProgress(1),"function"==typeof (e=this.delegate).requestFinished&&e.requestFinished(),this.delegate=null,this.xhr=null},r}()}.call(this),function(){var n=function(e,t){return function(){return e.apply(t,arguments)}};e.ProgressBar=function(){function e(){this.trickle=n(this.trickle,this),this.stylesheetElement=this.createStylesheetElement(),this.progressElement=this.createProgressElement()}var t;return t=300,e.defaultCSS=".turbolinks-progress-bar {\n  position: fixed;\n  display: block;\n  top: 0;\n  left: 0;\n  height: 3px;\n  background: #0076ff;\n  z-index: 9999;\n  transition: width "+t+"ms ease-out, opacity "+t/2+"ms "+t/2+"ms ease-in;\n  transform: translate3d(0, 0, 0);\n}",e.prototype.show=function(){return this.visible?void 0:(this.visible=!0,this.installStylesheetElement(),this.installProgressElement(),this.startTrickling())},e.prototype.hide=function(){return this.visible&&!this.hiding?(this.hiding=!0,this.fadeProgressElement(function(e){return function(){return e.uninstallProgressElement(),e.stopTrickling(),e.visible=!1,e.hiding=!1}}(this))):void 0},e.prototype.setValue=function(e){return this.value=e,this.refresh()},e.prototype.installStylesheetElement=function(){return document.head.insertBefore(this.stylesheetElement,document.head.firstChild)},e.prototype.installProgressElement=function(){return this.progressElement.style.width=0,this.progressElement.style.opacity=1,document.documentElement.insertBefore(this.progressElement,document.body),this.refresh()},e.prototype.fadeProgressElement=function(e){return this.progressElement.style.opacity=0,setTimeout(e,1.5*t)},e.prototype.uninstallProgressElement=function(){return this.progressElement.parentNode?document.documentElement.removeChild(this.progressElement):void 0},e.prototype.startTrickling=function(){return null!=this.trickleInterval?this.trickleInterval:this.trickleInterval=setInterval(this.trickle,t)},e.prototype.stopTrickling=function(){return clearInterval(this.trickleInterval),this.trickleInterval=null},e.prototype.trickle=function(){return this.setValue(this.value+Math.random()/100)},e.prototype.refresh=function(){return requestAnimationFrame(function(e){return function(){return e.progressElement.style.width=10+90*e.value+"%"}}(this))},e.prototype.createStylesheetElement=function(){var e;return e=document.createElement("style"),e.type="text/css",e.textContent=this.constructor.defaultCSS,e},e.prototype.createProgressElement=function(){var e;return e=document.createElement("div"),e.className="turbolinks-progress-bar",e},e}()}.call(this),function(){var n=function(e,t){return function(){return e.apply(t,arguments)}};e.BrowserAdapter=function(){function r(r){this.controller=r,this.showProgressBar=n(this.showProgressBar,this),this.progressBar=new e.ProgressBar}var i,s,o,u;return u=e.HttpRequest,i=u.NETWORK_FAILURE,o=u.TIMEOUT_FAILURE,s=500,r.prototype.visitProposedToLocationWithAction=function(e,t){return this.controller.startVisitToLocationWithAction(e,t)},r.prototype.visitStarted=function(e){return e.issueRequest(),e.changeHistory(),e.loadCachedSnapshot()},r.prototype.visitRequestStarted=function(e){return this.progressBar.setValue(0),e.hasCachedSnapshot()||"restore"!==e.action?this.showProgressBarAfterDelay():this.showProgressBar()},r.prototype.visitRequestProgressed=function(e){return this.progressBar.setValue(e.progress)},r.prototype.visitRequestCompleted=function(e){return e.loadResponse()},r.prototype.visitRequestFailedWithStatusCode=function(e,t){switch(t){case i:case o:return this.reload();default:return e.loadResponse()}},r.prototype.visitRequestFinished=function(e){return this.hideProgressBar()},r.prototype.visitCompleted=function(e){return e.followRedirect()},r.prototype.pageInvalidated=function(){return this.reload()},r.prototype.showProgressBarAfterDelay=function(){return this.progressBarTimeout=setTimeout(this.showProgressBar,s)},r.prototype.showProgressBar=function(){return this.progressBar.show()},r.prototype.hideProgressBar=function(){return this.progressBar.hide(),clearTimeout(this.progressBarTimeout)},r.prototype.reload=function(){return window.location.reload()},r}()}.call(this),function(){var n,r=function(e,t){return function(){return e.apply(t,arguments)}};n=!1,addEventListener("load",function(){return e.defer(function(){return n=!0})},!1),e.History=function(){function i(e){this.delegate=e,this.onPopState=r(this.onPopState,this)}return i.prototype.start=function(){return this.started?void 0:(addEventListener("popstate",this.onPopState,!1),this.started=!0)},i.prototype.stop=function(){return this.started?(removeEventListener("popstate",this.onPopState,!1),this.started=!1):void 0},i.prototype.push=function(n,r){return n=e.Location.wrap(n),this.update("push",n,r)},i.prototype.replace=function(n,r){return n=e.Location.wrap(n),this.update("replace",n,r)},i.prototype.onPopState=function(n){var r,i,s,o;return this.shouldHandlePopState()&&(o=null!=(i=n.state)?i.turbolinks:void 0)?(r=e.Location.wrap(window.location),s=o.restorationIdentifier,this.delegate.historyPoppedToLocationWithRestorationIdentifier(r,s)):void 0},i.prototype.shouldHandlePopState=function(){return n===!0},i.prototype.update=function(e,t,n){var r;return r={turbolinks:{restorationIdentifier:n}},history[e+"State"](r,null,t)},i}()}.call(this),function(){e.Snapshot=function(){function n(e){var t,n;n=e.head,t=e.body,this.head=null!=n?n:document.createElement("head"),this.body=null!=t?t:document.createElement("body")}return n.wrap=function(e){return e instanceof this?e:this.fromHTML(e)},n.fromHTML=function(e){var t;return t=document.createElement("html"),t.innerHTML=e,this.fromElement(t)},n.fromElement=function(e){return new this({head:e.querySelector("head"),body:e.querySelector("body")})},n.prototype.clone=function(){return new n({head:this.head.cloneNode(!0),body:this.body.cloneNode(!0)})},n.prototype.getRootLocation=function(){var n,r;return r=null!=(n=this.getSetting("root"))?n:"/",new e.Location(r)},n.prototype.getCacheControlValue=function(){return this.getSetting("cache-control")},n.prototype.hasAnchor=function(e){try{return null!=this.body.querySelector("[id='"+e+"']")}catch(t){}},n.prototype.isPreviewable=function(){return"no-preview"!==this.getCacheControlValue()},n.prototype.isCacheable=function(){return"no-cache"!==this.getCacheControlValue()},n.prototype.getSetting=function(e){var t,n;return n=this.head.querySelectorAll("meta[name='turbolinks-"+e+"']"),t=n[n.length-1],null!=t?t.getAttribute("content"):void 0},n}()}.call(this),function(){var n=[].slice;e.Renderer=function(){function e(){}var t;return e.render=function(){var e,t,r,i;return r=arguments[0],t=arguments[1],e=3<=arguments.length?n.call(arguments,2):[],i=function(e,t,n){n.prototype=e.prototype;var r=new n,i=e.apply(r,t);return Object(i)===i?i:r}(this,e,function(){}),i.delegate=r,i.render(t),i},e.prototype.renderView=function(e){return this.delegate.viewWillRender(this.newBody),e(),this.delegate.viewRendered(this.newBody)},e.prototype.invalidateView=function(){return this.delegate.viewInvalidated()},e.prototype.createScriptElement=function(e){var n;return"false"===e.getAttribute("data-turbolinks-eval")?e:(n=document.createElement("script"),n.textContent=e.textContent,t(n,e),n)},t=function(e,t){var n,r,i,s,o,u,a;for(s=t.attributes,u=[],n=0,r=s.length;r>n;n++)o=s[n],i=o.name,a=o.value,u.push(e.setAttribute(i,a));return u},e}()}.call(this),function(){e.HeadDetails=function(){function e(e){var t,n,s,u,a,f,l;for(this.element=e,this.elements={},l=this.element.childNodes,u=0,f=l.length;f>u;u++)s=l[u],s.nodeType===Node.ELEMENT_NODE&&(a=s.outerHTML,n=null!=(t=this.elements)[a]?t[a]:t[a]={type:i(s),tracked:r(s),elements:[]},n.elements.push(s))}var t,n,r,i;return e.prototype.hasElementWithKey=function(e){return e in this.elements},e.prototype.getTrackedElementSignature=function(){var e,t;return function(){var n,r;n=this.elements,r=[];for(e in n)t=n[e].tracked,t&&r.push(e);return r}.call(this).join("")},e.prototype.getScriptElementsNotInDetails=function(e){return this.getElementsMatchingTypeNotInDetails("script",e)},e.prototype.getStylesheetElementsNotInDetails=function(e){return this.getElementsMatchingTypeNotInDetails("stylesheet",e)},e.prototype.getElementsMatchingTypeNotInDetails=function(e,t){var n,r,i,s,o,u;i=this.elements,o=[];for(r in i)s=i[r],u=s.type,n=s.elements,u!==e||t.hasElementWithKey(r)||o.push(n[0]);return o},e.prototype.getProvisionalElements=function(){var e,t,n,r,i,s,o;n=[],r=this.elements;for(t in r)i=r[t],o=i.type,s=i.tracked,e=i.elements,null!=o||s?e.length>1&&n.push.apply(n,e.slice(1)):n.push.apply(n,e);return n},i=function(e){return t(e)?"script":n(e)?"stylesheet":void 0},r=function(e){return"reload"===e.getAttribute("data-turbolinks-track")},t=function(e){var t;return t=e.tagName.toLowerCase(),"script"===t},n=function(e){var t;return t=e.tagName.toLowerCase(),"style"===t||"link"===t&&"stylesheet"===e.getAttribute("rel")},e}()}.call(this),function(){var n=function(e,t){function n(){this.constructor=e}for(var i in t)r.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},r={}.hasOwnProperty;e.SnapshotRenderer=function(r){function i(n,r){this.currentSnapshot=n,this.newSnapshot=r,this.currentHeadDetails=new e.HeadDetails(this.currentSnapshot.head),this.newHeadDetails=new e.HeadDetails(this.newSnapshot.head),this.newBody=this.newSnapshot.body}return n(i,r),i.prototype.render=function(e){return this.trackedElementsAreIdentical()?(this.mergeHead(),this.renderView(function(n){return function(){return n.replaceBody(),n.focusFirstAutofocusableElement(),e()}}(this))):this.invalidateView()},i.prototype.mergeHead=function(){return this.copyNewHeadStylesheetElements(),this.copyNewHeadScriptElements(),this.removeCurrentHeadProvisionalElements(),this.copyNewHeadProvisionalElements()},i.prototype.replaceBody=function(){return this.activateBodyScriptElements(),this.importBodyPermanentElements(),this.assignNewBody()},i.prototype.trackedElementsAreIdentical=function(){return this.currentHeadDetails.getTrackedElementSignature()===this.newHeadDetails.getTrackedElementSignature()},i.prototype.copyNewHeadStylesheetElements=function(){var e,t,n,r,i;for(r=this.getNewHeadStylesheetElements(),i=[],t=0,n=r.length;n>t;t++)e=r[t],i.push(document.head.appendChild(e));return i},i.prototype.copyNewHeadScriptElements=function(){var e,t,n,r,i;for(r=this.getNewHeadScriptElements(),i=[],t=0,n=r.length;n>t;t++)e=r[t],i.push(document.head.appendChild(this.createScriptElement(e)));return i},i.prototype.removeCurrentHeadProvisionalElements=function(){var e,t,n,r,i;for(r=this.getCurrentHeadProvisionalElements(),i=[],t=0,n=r.length;n>t;t++)e=r[t],i.push(document.head.removeChild(e));return i},i.prototype.copyNewHeadProvisionalElements=function(){var e,t,n,r,i;for(r=this.getNewHeadProvisionalElements(),i=[],t=0,n=r.length;n>t;t++)e=r[t],i.push(document.head.appendChild(e));return i},i.prototype.importBodyPermanentElements=function(){var e,t,n,r,i,s;for(r=this.getNewBodyPermanentElements(),s=[],t=0,n=r.length;n>t;t++)i=r[t],(e=this.findCurrentBodyPermanentElement(i))?s.push(i.parentNode.replaceChild(e,i)):s.push(void 0);return s},i.prototype.activateBodyScriptElements=function(){var e,t,n,r,i,s;for(r=this.getNewBodyScriptElements(),s=[],t=0,n=r.length;n>t;t++)i=r[t],e=this.createScriptElement(i),s.push(i.parentNode.replaceChild(e,i));return s},i.prototype.assignNewBody=function(){return document.body=this.newBody},i.prototype.focusFirstAutofocusableElement=function(){var e;return null!=(e=this.findFirstAutofocusableElement())?e.focus():void 0},i.prototype.getNewHeadStylesheetElements=function(){return this.newHeadDetails.getStylesheetElementsNotInDetails(this.currentHeadDetails)},i.prototype.getNewHeadScriptElements=function(){return this.newHeadDetails.getScriptElementsNotInDetails(this.currentHeadDetails)},i.prototype.getCurrentHeadProvisionalElements=function(){return this.currentHeadDetails.getProvisionalElements()},i.prototype.getNewHeadProvisionalElements=function(){return this.newHeadDetails.getProvisionalElements()},i.prototype.getNewBodyPermanentElements=function(){return this.newBody.querySelectorAll("[id][data-turbolinks-permanent]")},i.prototype.findCurrentBodyPermanentElement=function(e){return document.body.querySelector("#"+e.id+"[data-turbolinks-permanent]")},i.prototype.getNewBodyScriptElements=function(){return this.newBody.querySelectorAll("script")},i.prototype.findFirstAutofocusableElement=function(){return document.body.querySelector("[autofocus]")},i}(e.Renderer)}.call(this),function(){var n=function(e,t){function n(){this.constructor=e}for(var i in t)r.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},r={}.hasOwnProperty;e.ErrorRenderer=function(e){function t(e){this.html=e}return n(t,e),t.prototype.render=function(e){return this.renderView(function(t){return function(){return t.replaceDocumentHTML(),t.activateBodyScriptElements(),e()}}(this))},t.prototype.replaceDocumentHTML=function(){return document.documentElement.innerHTML=this.html},t.prototype.activateBodyScriptElements=function(){var e,t,n,r,i,s;for(r=this.getScriptElements(),s=[],t=0,n=r.length;n>t;t++)i=r[t],e=this.createScriptElement(i),s.push(i.parentNode.replaceChild(e,i));return s},t.prototype.getScriptElements=function(){return document.documentElement.querySelectorAll("script")},t}(e.Renderer)}.call(this),function(){e.View=function(){function n(e){this.delegate=e,this.element=document.documentElement}return n.prototype.getRootLocation=function(){return this.getSnapshot().getRootLocation()},n.prototype.getSnapshot=function(){return e.Snapshot.fromElement(this.element)},n.prototype.render=function(e,t){var n,r,i;return i=e.snapshot,n=e.error,r=e.isPreview,this.markAsPreview(r),null!=i?this.renderSnapshot(i,t):this.renderError(n,t)},n.prototype.markAsPreview=function(e){return e?this.element.setAttribute("data-turbolinks-preview",""):this.element.removeAttribute("data-turbolinks-preview")},n.prototype.renderSnapshot=function(n,r){return e.SnapshotRenderer.render(this.delegate,r,this.getSnapshot(),e.Snapshot.wrap(n))},n.prototype.renderError=function(n,r){return e.ErrorRenderer.render(this.delegate,r,n)},n}()}.call(this),function(){var n=function(e,t){return function(){return e.apply(t,arguments)}};e.ScrollManager=function(){function e(e){this.delegate=e,this.onScroll=n(this.onScroll,this)}return e.prototype.start=function(){return this.started?void 0:(addEventListener("scroll",this.onScroll,!1),this.onScroll(),this.started=!0)},e.prototype.stop=function(){return this.started?(removeEventListener("scroll",this.onScroll,!1),this.started=!1):void 0},e.prototype.scrollToElement=function(e){return e.scrollIntoView()},e.prototype.scrollToPosition=function(e){var t,n;return t=e.x,n=e.y,window.scrollTo(t,n)},e.prototype.onScroll=function(e){return this.updatePosition({x:window.pageXOffset,y:window.pageYOffset})},e.prototype.updatePosition=function(e){var t;return this.position=e,null!=(t=this.delegate)?t.scrollPositionChanged(this.position):void 0},e}()}.call(this),function(){e.SnapshotCache=function(){function n(e){this.size=e,this.keys=[],this.snapshots={}}var r;return n.prototype.has=function(e){var t;return t=r(e),t in this.snapshots},n.prototype.get=function(e){var t;if(this.has(e))return t=this.read(e),this.touch(e),t},n.prototype.put=function(e,t){return this.write(e,t),this.touch(e),t},n.prototype.read=function(e){var t;return t=r(e),this.snapshots[t]},n.prototype.write=function(e,t){var n;return n=r(e),this.snapshots[n]=t},n.prototype.touch=function(e){var t,n;return n=r(e),t=this.keys.indexOf(n),t>-1&&this.keys.splice(t,1),this.keys.unshift(n),this.trim()},n.prototype.trim=function(){var e,t,n,r,i;for(r=this.keys.splice(this.size),i=[],e=0,n=r.length;n>e;e++)t=r[e],i.push(delete this.snapshots[t]);return i},r=function(n){return e.Location.wrap(n).toCacheKey()},n}()}.call(this),function(){var n=function(e,t){return function(){return e.apply(t,arguments)}};e.Visit=function(){function r(r,i,s){this.controller=r,this.action=s,this.performScroll=n(this.performScroll,this),this.identifier=e.uuid(),this.location=e.Location.wrap(i),this.adapter=this.controller.adapter,this.state="initialized",this.timingMetrics={}}var i;return r.prototype.start=function(){return"initialized"===this.state?(this.recordTimingMetric("visitStart"),this.state="started",this.adapter.visitStarted(this)):void 0},r.prototype.cancel=function(){var e;return"started"===this.state?(null!=(e=this.request)&&e.cancel(),this.cancelRender(),this.state="canceled"):void 0},r.prototype.complete=function(){var e;return"started"===this.state?(this.recordTimingMetric("visitEnd"),this.state="completed","function"==typeof (e=this.adapter).visitCompleted&&e.visitCompleted(this),this.controller.visitCompleted(this)):void 0},r.prototype.fail=function(){var e;return"started"===this.state?(this.state="failed","function"==typeof (e=this.adapter).visitFailed?e.visitFailed(this):void 0):void 0},r.prototype.changeHistory=function(){var e,t;return this.historyChanged?void 0:(e=this.location.isEqualTo(this.referrer)?"replace":this.action,t=i(e),this.controller[t](this.location,this.restorationIdentifier),this.historyChanged=!0)},r.prototype.issueRequest=function(){return this.shouldIssueRequest()&&null==this.request?(this.progress=0,this.request=new e.HttpRequest(this,this.location,this.referrer),this.request.send()):void 0},r.prototype.getCachedSnapshot=function(){var e;return!(e=this.controller.getCachedSnapshotForLocation(this.location))||null!=this.location.anchor&&!e.hasAnchor(this.location.anchor)||"restore"!==this.action&&!e.isPreviewable()?void 0:e},r.prototype.hasCachedSnapshot=function(){return null!=this.getCachedSnapshot()},r.prototype.loadCachedSnapshot=function(){var e,t;return(t=this.getCachedSnapshot())?(e=this.shouldIssueRequest(),this.render(function(){var n;return this.cacheSnapshot(),this.controller.render({snapshot:t,isPreview:e},this.performScroll),"function"==typeof (n=this.adapter).visitRendered&&n.visitRendered(this),e?void 0:this.complete()})):void 0},r.prototype.loadResponse=function(){return null!=this.response?this.render(function(){var e,t;return this.cacheSnapshot(),this.request.failed?(this.controller.render({error:this.response},this.performScroll),"function"==typeof (e=this.adapter).visitRendered&&e.visitRendered(this),this.fail()):(this.controller.render({snapshot:this.response},this.performScroll),"function"==typeof (t=this.adapter).visitRendered&&t.visitRendered(this),this.complete())}):void 0},r.prototype.followRedirect=function(){return this.redirectedToLocation&&!this.followedRedirect?(this.location=this.redirectedToLocation,this.controller.replaceHistoryWithLocationAndRestorationIdentifier(this.redirectedToLocation,this.restorationIdentifier),this.followedRedirect=!0):void 0},r.prototype.requestStarted=function(){var e;return this.recordTimingMetric("requestStart"),"function"==typeof (e=this.adapter).visitRequestStarted?e.visitRequestStarted(this):void 0},r.prototype.requestProgressed=function(e){var t;return this.progress=e,"function"==typeof (t=this.adapter).visitRequestProgressed?t.visitRequestProgressed(this):void 0},r.prototype.requestCompletedWithResponse=function(n,r){return this.response=n,null!=r&&(this.redirectedToLocation=e.Location.wrap(r)),this.adapter.visitRequestCompleted(this)},r.prototype.requestFailedWithStatusCode=function(e,t){return this.response=t,this.adapter.visitRequestFailedWithStatusCode(this,e)},r.prototype.requestFinished=function(){var e;return this.recordTimingMetric("requestEnd"),"function"==typeof (e=this.adapter).visitRequestFinished?e.visitRequestFinished(this):void 0},r.prototype.performScroll=function(){return this.scrolled?void 0:("restore"===this.action?this.scrollToRestoredPosition()||this.scrollToTop():this.scrollToAnchor()||this.scrollToTop(),this.scrolled=!0)},r.prototype.scrollToRestoredPosition=function(){var e,t;return e=null!=(t=this.restorationData)?t.scrollPosition:void 0,null!=e?(this.controller.scrollToPosition(e),!0):void 0},r.prototype.scrollToAnchor=function(){return null!=this.location.anchor?(this.controller.scrollToAnchor(this.location.anchor),!0):void 0},r.prototype.scrollToTop=function(){return this.controller.scrollToPosition({x:0,y:0})},r.prototype.recordTimingMetric=function(e){var t;return null!=(t=this.timingMetrics)[e]?t[e]:t[e]=(new Date).getTime()},r.prototype.getTimingMetrics=function(){return e.copyObject(this.timingMetrics)},i=function(e){switch(e){case"replace":return"replaceHistoryWithLocationAndRestorationIdentifier";case"advance":case"restore":return"pushHistoryWithLocationAndRestorationIdentifier"}},r.prototype.shouldIssueRequest=function(){return"restore"===this.action?!this.hasCachedSnapshot():!0},r.prototype.cacheSnapshot=function(){return this.snapshotCached?void 0:(this.controller.cacheSnapshot(),this.snapshotCached=!0)},r.prototype.render=function(e){return this.cancelRender(),this.frame=requestAnimationFrame(function(n){return function(){return n.frame=null,e.call(n)}}(this))},r.prototype.cancelRender=function(){return this.frame?cancelAnimationFrame(this.frame):void 0},r}()}.call(this),function(){var n=function(e,t){return function(){return e.apply(t,arguments)}};e.Controller=function(){function r(){this.clickBubbled=n(this.clickBubbled,this),this.clickCaptured=n(this.clickCaptured,this),this.pageLoaded=n(this.pageLoaded,this),this.history=new e.History(this),this.view=new e.View(this),this.scrollManager=new e.ScrollManager(this),this.restorationData={},this.clearCache()}return r.prototype.start=function(){return e.supported&&!this.started?(addEventListener("click",this.clickCaptured,!0),addEventListener("DOMContentLoaded",this.pageLoaded,!1),this.scrollManager.start(),this.startHistory(),this.started=!0,this.enabled=!0):void 0},r.prototype.disable=function(){return this.enabled=!1},r.prototype.stop=function(){return this.started?(removeEventListener("click",this.clickCaptured,!0),removeEventListener("DOMContentLoaded",this.pageLoaded,!1),this.scrollManager.stop(),this.stopHistory(),this.started=!1):void 0},r.prototype.clearCache=function(){return this.cache=new e.SnapshotCache(10)},r.prototype.visit=function(n,r){var i,s;return null==r&&(r={}),n=e.Location.wrap(n),this.applicationAllowsVisitingLocation(n)?this.locationIsVisitable(n)?(i=null!=(s=r.action)?s:"advance",this.adapter.visitProposedToLocationWithAction(n,i)):window.location=n:void 0},r.prototype.startVisitToLocationWithAction=function(n,r,i){var s;return e.supported?(s=this.getRestorationDataForIdentifier(i),this.startVisit(n,r,{restorationData:s})):window.location=n},r.prototype.startHistory=function(){return this.location=e.Location.wrap(window.location),this.restorationIdentifier=e.uuid(),this.history.start(),this.history.replace(this.location,this.restorationIdentifier)},r.prototype.stopHistory=function(){return this.history.stop()},r.prototype.pushHistoryWithLocationAndRestorationIdentifier=function(n,r){return this.restorationIdentifier=r,this.location=e.Location.wrap(n),this.history.push(this.location,this.restorationIdentifier)},r.prototype.replaceHistoryWithLocationAndRestorationIdentifier=function(n,r){return this.restorationIdentifier=r,this.location=e.Location.wrap(n),this.history.replace(this.location,this.restorationIdentifier)},r.prototype.historyPoppedToLocationWithRestorationIdentifier=function(n,r){var i;return this.restorationIdentifier=r,this.enabled?(i=this.getRestorationDataForIdentifier(this.restorationIdentifier),this.startVisit(n,"restore",{restorationIdentifier:this.restorationIdentifier,restorationData:i,historyChanged:!0}),this.location=e.Location.wrap(n)):this.adapter.pageInvalidated()},r.prototype.getCachedSnapshotForLocation=function(e){var t;return t=this.cache.get(e),t?t.clone():void 0},r.prototype.shouldCacheSnapshot=function(){return this.view.getSnapshot().isCacheable()},r.prototype.cacheSnapshot=function(){var e;return this.shouldCacheSnapshot()?(this.notifyApplicationBeforeCachingSnapshot(),e=this.view.getSnapshot(),this.cache.put(this.lastRenderedLocation,e.clone())):void 0},r.prototype.scrollToAnchor=function(e){var t;return(t=document.getElementById(e))?this.scrollToElement(t):this.scrollToPosition({x:0,y:0})},r.prototype.scrollToElement=function(e){return this.scrollManager.scrollToElement(e)},r.prototype.scrollToPosition=function(e){return this.scrollManager.scrollToPosition(e)},r.prototype.scrollPositionChanged=function(e){var t;return t=this.getCurrentRestorationData(),t.scrollPosition=e},r.prototype.render=function(e,t){return this.view.render(e,t)},r.prototype.viewInvalidated=function(){return this.adapter.pageInvalidated()},r.prototype.viewWillRender=function(e){return this.notifyApplicationBeforeRender(e)},r.prototype.viewRendered=function(){return this.lastRenderedLocation=this.currentVisit.location,this.notifyApplicationAfterRender()},r.prototype.pageLoaded=function(){return this.lastRenderedLocation=this.location,this.notifyApplicationAfterPageLoad()},r.prototype.clickCaptured=function(){return removeEventListener("click",this.clickBubbled,!1),addEventListener("click",this.clickBubbled,!1)},r.prototype.clickBubbled=function(e){var t,n,r;return this.enabled&&this.clickEventIsSignificant(e)&&(n=this.getVisitableLinkForNode(e.target))&&(r=this.getVisitableLocationForLink(n))&&this.applicationAllowsFollowingLinkToLocation(n,r)?(e.preventDefault(),t=this.getActionForLink(n),this.visit(r,{action:t})):void 0},r.prototype.applicationAllowsFollowingLinkToLocation=function(e,t){var n;return n=this.notifyApplicationAfterClickingLinkToLocation(e,t),!n.defaultPrevented},r.prototype.applicationAllowsVisitingLocation=function(e){var t;return t=this.notifyApplicationBeforeVisitingLocation(e),!t.defaultPrevented},r.prototype.notifyApplicationAfterClickingLinkToLocation=function(n,r){return e.dispatch("turbolinks:click",{target:n,data:{url:r.absoluteURL},cancelable:!0})},r.prototype.notifyApplicationBeforeVisitingLocation=function(n){return e.dispatch("turbolinks:before-visit",{data:{url:n.absoluteURL},cancelable:!0})},r.prototype.notifyApplicationAfterVisitingLocation=function(n){return e.dispatch("turbolinks:visit",{data:{url:n.absoluteURL}})},r.prototype.notifyApplicationBeforeCachingSnapshot=function(){return e.dispatch("turbolinks:before-cache")},r.prototype.notifyApplicationBeforeRender=function(n){return e.dispatch("turbolinks:before-render",{data:{newBody:n}})},r.prototype.notifyApplicationAfterRender=function(){return e.dispatch("turbolinks:render")},r.prototype.notifyApplicationAfterPageLoad=function(n){return null==n&&(n={}),e.dispatch("turbolinks:load",{data:{url:this.location.absoluteURL,timing:n}})},r.prototype.startVisit=function(e,t,n){var r;return null!=(r=this.currentVisit)&&r.cancel(),this.currentVisit=this.createVisit(e,t,n),this.currentVisit.start(),this.notifyApplicationAfterVisitingLocation(e)},r.prototype.createVisit=function(n,r,i){var s,o,u,a,f;return o=null!=i?i:{},a=o.restorationIdentifier,u=o.restorationData,s=o.historyChanged,f=new e.Visit(this,n,r),f.restorationIdentifier=null!=a?a:e.uuid(),f.restorationData=e.copyObject(u),f.historyChanged=s,f.referrer=this.location,f},r.prototype.visitCompleted=function(e){return this.notifyApplicationAfterPageLoad(e.getTimingMetrics())},r.prototype.clickEventIsSignificant=function(e){return!(e.defaultPrevented||e.target.isContentEditable||e.which>1||e.altKey||e.ctrlKey||e.metaKey||e.shiftKey)},r.prototype.getVisitableLinkForNode=function(n){return this.nodeIsVisitable(n)?e.closest(n,"a[href]:not([target])"):void 0},r.prototype.getVisitableLocationForLink=function(n){var r;return r=new e.Location(n.getAttribute("href")),this.locationIsVisitable(r)?r:void 0},r.prototype.getActionForLink=function(e){var t;return null!=(t=e.getAttribute("data-turbolinks-action"))?t:"advance"},r.prototype.nodeIsVisitable=function(n){var r;return(r=e.closest(n,"[data-turbolinks]"))?"false"!==r.getAttribute("data-turbolinks"):!0},r.prototype.locationIsVisitable=function(e){return e.isPrefixedBy(this.view.getRootLocation())&&e.isHTML()},r.prototype.getCurrentRestorationData=function(){return this.getRestorationDataForIdentifier(this.restorationIdentifier)},r.prototype.getRestorationDataForIdentifier=function(e){var t;return null!=(t=this.restorationData)[e]?t[e]:t[e]={}},r}()}.call(this),function(){var n,r,i;e.start=function(){return r()?(null==e.controller&&(e.controller=n()),e.controller.start()):void 0},r=function(){return null==window.Turbolinks&&(window.Turbolinks=e),i()},n=function(){var n;return n=new e.Controller,n.adapter=new e.BrowserAdapter(n),n},i=function(){return window.Turbolinks===e},i()&&e.start()}.call(this)}).call(this),"object"==typeof module&&module.exports?module.exports=e:"function"==typeof define&&define.amd&&define(e)}).call(this);